/*
 The MIT License (MIT)

 Copyright (C) 2017-2021 Stefano Cappa (Ks89)

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in all
 copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NON INFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 SOFTWARE.
 */
import { Injectable } from '@angular/core';
import { KS_DEFAULT_ACCESSIBILITY_CONFIG } from '../components/accessibility-default';
import { ButtonsStrategy } from '../model/buttons-config.interface';
import { GridLayout, LineLayout, PlainGalleryStrategy } from '../model/plain-gallery-config.interface';
import { LoadingType } from '../model/loading-config.interface';
import { DescriptionStrategy } from '../model/description.interface';
import * as i0 from "@angular/core";
export const DEFAULT_PREVIEW_SIZE = { height: '50px', width: 'auto' };
export const DEFAULT_LAYOUT = new LineLayout(DEFAULT_PREVIEW_SIZE, { length: -1, wrap: false }, 'flex-start');
export const DEFAULT_PLAIN_CONFIG = {
    strategy: PlainGalleryStrategy.ROW,
    layout: DEFAULT_LAYOUT,
    advanced: { aTags: false, additionalBackground: '50% 50%/cover' }
};
export const DEFAULT_LOADING = { enable: true, type: LoadingType.STANDARD };
export const DEFAULT_DESCRIPTION_STYLE = {
    bgColor: 'rgba(0, 0, 0, .5)',
    textColor: 'white',
    marginTop: '0px',
    marginBottom: '0px',
    marginLeft: '0px',
    marginRight: '0px'
};
export const DEFAULT_DESCRIPTION = {
    strategy: DescriptionStrategy.ALWAYS_VISIBLE,
    imageText: 'Image ',
    numberSeparator: '/',
    beforeTextDescription: ' - ',
    style: DEFAULT_DESCRIPTION_STYLE
};
export const DEFAULT_CAROUSEL_DESCRIPTION = {
    strategy: DescriptionStrategy.ALWAYS_HIDDEN,
    imageText: 'Image ',
    numberSeparator: '/',
    beforeTextDescription: ' - ',
    style: DEFAULT_DESCRIPTION_STYLE
};
export const DEFAULT_CURRENT_IMAGE_CONFIG = {
    navigateOnClick: true,
    loadingConfig: DEFAULT_LOADING,
    description: DEFAULT_DESCRIPTION,
    downloadable: false,
    invertSwipe: false
};
export const DEFAULT_CAROUSEL_IMAGE_CONFIG = {
    description: DEFAULT_CAROUSEL_DESCRIPTION,
    invertSwipe: false
};
export const DEFAULT_CURRENT_CAROUSEL_CONFIG = {
    maxWidth: '100%',
    maxHeight: '400px',
    showArrows: true,
    objectFit: 'cover',
    keyboardEnable: true,
    modalGalleryEnable: false
};
export const DEFAULT_CURRENT_CAROUSEL_PLAY = {
    autoPlay: true,
    interval: 5000,
    pauseOnHover: true
};
export const DEFAULT_CAROUSEL_BREAKPOINTS = { xSmall: 100, small: 100, medium: 150, large: 200, xLarge: 200 };
export const DEFAULT_CAROUSEL_PREVIEWS_CONFIG = {
    visible: true,
    number: 4,
    arrows: true,
    clickable: true,
    width: 100 / 4 + '%',
    maxHeight: '200px',
    breakpoints: DEFAULT_CAROUSEL_BREAKPOINTS
};
export const DEFAULT_KEYBOARD_SERVICE_CONFIG = {
    shortcuts: ['ctrl+s', 'meta+s'],
    disableSsrWorkaround: false
};
export const DEFAULT_SLIDE_CONFIG = {
    infinite: false,
    playConfig: { autoPlay: false, interval: 5000, pauseOnHover: true },
    sidePreviews: { show: true, size: { width: '100px', height: 'auto' } }
};
export const DEFAULT_PREVIEW_CONFIG = {
    visible: true,
    number: 3,
    arrows: true,
    clickable: true,
    size: DEFAULT_PREVIEW_SIZE
};
const DEFAULT_CONFIG = Object.freeze({
    slideConfig: DEFAULT_SLIDE_CONFIG,
    accessibilityConfig: KS_DEFAULT_ACCESSIBILITY_CONFIG,
    previewConfig: DEFAULT_PREVIEW_CONFIG,
    buttonsConfig: { visible: true, strategy: ButtonsStrategy.DEFAULT },
    dotsConfig: { visible: true },
    plainGalleryConfig: DEFAULT_PLAIN_CONFIG,
    currentImageConfig: DEFAULT_CURRENT_IMAGE_CONFIG,
    keyboardConfig: undefined,
    carouselConfig: DEFAULT_CURRENT_CAROUSEL_CONFIG,
    carouselImageConfig: DEFAULT_CAROUSEL_IMAGE_CONFIG,
    carouselPreviewsConfig: DEFAULT_CAROUSEL_PREVIEWS_CONFIG,
    carouselPlayConfig: DEFAULT_CURRENT_CAROUSEL_PLAY,
    carouselDotsConfig: { visible: true },
    carouselSlideInfinite: true,
    enableCloseOutside: true,
    keyboardServiceConfig: DEFAULT_KEYBOARD_SERVICE_CONFIG
});
/**
 * Service to handle library configuration in a unique place
 */
export class ConfigService {
    constructor() {
        this.configMap = new Map();
    }
    getConfig(id) {
        this.initIfNotExists(id);
        return this.configMap.get(id);
    }
    setConfig(id, obj) {
        this.initIfNotExists(id);
        if (!obj) {
            return;
        }
        if (!DEFAULT_CONFIG ||
            !DEFAULT_CONFIG.slideConfig ||
            !DEFAULT_CONFIG.slideConfig.sidePreviews ||
            !DEFAULT_CONFIG.previewConfig ||
            !DEFAULT_CONFIG.previewConfig.size ||
            !DEFAULT_CONFIG.previewConfig.number ||
            !DEFAULT_CONFIG.plainGalleryConfig ||
            !DEFAULT_CONFIG.currentImageConfig ||
            !DEFAULT_CONFIG.currentImageConfig ||
            !DEFAULT_CONFIG.currentImageConfig.description ||
            !DEFAULT_CONFIG.carouselImageConfig ||
            !DEFAULT_CONFIG.carouselImageConfig.description ||
            !DEFAULT_CONFIG.carouselPreviewsConfig ||
            !DEFAULT_CONFIG.carouselPreviewsConfig.breakpoints ||
            !DEFAULT_CAROUSEL_PREVIEWS_CONFIG.number) {
            throw new Error('Internal library error - DEFAULT_CONFIG must be fully initialized!!!');
        }
        const newConfig = Object.assign({}, this.configMap.get(id));
        if (obj.slideConfig) {
            let playConfig;
            let sidePreviews;
            let size;
            if (obj.slideConfig.playConfig) {
                playConfig = Object.assign({}, DEFAULT_CONFIG.slideConfig.playConfig, obj.slideConfig.playConfig);
            }
            else {
                playConfig = DEFAULT_CONFIG.slideConfig.playConfig;
            }
            if (obj.slideConfig.sidePreviews) {
                if (obj.slideConfig.sidePreviews.size) {
                    size = Object.assign({}, DEFAULT_CONFIG.slideConfig.sidePreviews.size, obj.slideConfig.sidePreviews.size);
                }
                else {
                    size = DEFAULT_CONFIG.slideConfig.sidePreviews.size;
                }
                sidePreviews = Object.assign({}, DEFAULT_CONFIG.slideConfig.sidePreviews, obj.slideConfig.sidePreviews);
            }
            else {
                sidePreviews = DEFAULT_CONFIG.slideConfig.sidePreviews;
                size = DEFAULT_CONFIG.slideConfig.sidePreviews.size;
            }
            const newSlideConfig = Object.assign({}, DEFAULT_CONFIG.slideConfig, obj.slideConfig);
            newSlideConfig.playConfig = playConfig;
            newSlideConfig.sidePreviews = sidePreviews;
            newSlideConfig.sidePreviews.size = size;
            newConfig.slideConfig = newSlideConfig;
        }
        if (obj.accessibilityConfig) {
            newConfig.accessibilityConfig = Object.assign({}, DEFAULT_CONFIG.accessibilityConfig, obj.accessibilityConfig);
        }
        if (obj.previewConfig) {
            let size;
            let num;
            if (obj.previewConfig.size) {
                size = Object.assign({}, DEFAULT_CONFIG.previewConfig.size, obj.previewConfig.size);
            }
            else {
                size = DEFAULT_CONFIG.previewConfig.size;
            }
            if (obj.previewConfig.number) {
                if (obj.previewConfig.number <= 0) {
                    // if number is <= 0 reset to default
                    num = DEFAULT_CONFIG.previewConfig.number;
                }
                else {
                    num = obj.previewConfig.number;
                }
            }
            else {
                num = DEFAULT_CONFIG.previewConfig.number;
            }
            const newPreviewConfig = Object.assign({}, DEFAULT_CONFIG.previewConfig, obj.previewConfig);
            newPreviewConfig.size = size;
            newPreviewConfig.number = num;
            newConfig.previewConfig = newPreviewConfig;
        }
        if (obj.buttonsConfig) {
            newConfig.buttonsConfig = Object.assign({}, DEFAULT_CONFIG.buttonsConfig, obj.buttonsConfig);
        }
        if (obj.dotsConfig) {
            newConfig.dotsConfig = Object.assign({}, DEFAULT_CONFIG.dotsConfig, obj.dotsConfig);
        }
        if (obj.plainGalleryConfig) {
            let advanced;
            let layout;
            if (obj.plainGalleryConfig.advanced) {
                advanced = Object.assign({}, DEFAULT_CONFIG.plainGalleryConfig.advanced, obj.plainGalleryConfig.advanced);
            }
            else {
                advanced = DEFAULT_CONFIG.plainGalleryConfig.advanced;
            }
            if (obj.plainGalleryConfig.layout) {
                // it isn't mandatory to use assign, because obj.plainGalleryConfig.layout is an instance of class (LineaLayout, GridLayout)
                layout = obj.plainGalleryConfig.layout;
            }
            else {
                layout = DEFAULT_CONFIG.plainGalleryConfig.layout;
            }
            const newPlainGalleryConfig = Object.assign({}, DEFAULT_CONFIG.plainGalleryConfig, obj.plainGalleryConfig);
            newPlainGalleryConfig.layout = layout;
            newPlainGalleryConfig.advanced = advanced;
            newConfig.plainGalleryConfig = initPlainGalleryConfig(newPlainGalleryConfig);
        }
        if (obj.currentImageConfig) {
            let loading;
            let description;
            let descriptionStyle;
            if (obj.currentImageConfig.loadingConfig) {
                loading = Object.assign({}, DEFAULT_CONFIG.currentImageConfig.loadingConfig, obj.currentImageConfig.loadingConfig);
            }
            else {
                loading = DEFAULT_CONFIG.currentImageConfig.loadingConfig;
            }
            if (obj.currentImageConfig.description) {
                description = Object.assign({}, DEFAULT_CONFIG.currentImageConfig.description, obj.currentImageConfig.description);
                if (obj.currentImageConfig.description.style) {
                    descriptionStyle = Object.assign({}, DEFAULT_CONFIG.currentImageConfig.description.style, obj.currentImageConfig.description.style);
                }
                else {
                    descriptionStyle = DEFAULT_CONFIG.currentImageConfig.description.style;
                }
            }
            else {
                description = DEFAULT_CONFIG.currentImageConfig.description;
                descriptionStyle = DEFAULT_CONFIG.currentImageConfig.description.style;
            }
            const newCurrentImageConfig = Object.assign({}, DEFAULT_CONFIG.currentImageConfig, obj.currentImageConfig);
            newCurrentImageConfig.loadingConfig = loading;
            newCurrentImageConfig.description = description;
            newCurrentImageConfig.description.style = descriptionStyle;
            newConfig.currentImageConfig = newCurrentImageConfig;
        }
        if (obj.keyboardConfig) {
            newConfig.keyboardConfig = Object.assign({}, DEFAULT_CONFIG.keyboardConfig, obj.keyboardConfig);
        }
        // carousel
        if (obj.carouselConfig) {
            newConfig.carouselConfig = Object.assign({}, DEFAULT_CONFIG.carouselConfig, obj.carouselConfig);
        }
        if (obj.carouselImageConfig) {
            let description;
            let descriptionStyle;
            if (obj.carouselImageConfig.description) {
                description = Object.assign({}, DEFAULT_CONFIG.carouselImageConfig.description, obj.carouselImageConfig.description);
                if (obj.carouselImageConfig.description.style) {
                    descriptionStyle = Object.assign({}, DEFAULT_CONFIG.carouselImageConfig.description.style, obj.carouselImageConfig.description.style);
                }
                else {
                    descriptionStyle = DEFAULT_CONFIG.carouselImageConfig.description.style;
                }
            }
            else {
                description = DEFAULT_CONFIG.carouselImageConfig.description;
                descriptionStyle = DEFAULT_CONFIG.carouselImageConfig.description.style;
            }
            const newCarouselImageConfig = Object.assign({}, DEFAULT_CONFIG.carouselImageConfig, obj.carouselImageConfig);
            newCarouselImageConfig.description = description;
            newCarouselImageConfig.description.style = descriptionStyle;
            newConfig.carouselImageConfig = newCarouselImageConfig;
        }
        if (obj.carouselPlayConfig) {
            // check values
            if (obj.carouselPlayConfig.interval <= 0) {
                throw new Error(`Carousel's interval must be a number >= 0`);
            }
            newConfig.carouselPlayConfig = Object.assign({}, DEFAULT_CONFIG.carouselPlayConfig, obj.carouselPlayConfig);
        }
        if (obj.carouselPreviewsConfig) {
            // check values
            let num;
            let breakpoints;
            if (!obj.carouselPreviewsConfig.number || obj.carouselPreviewsConfig.number <= 0) {
                num = DEFAULT_CAROUSEL_PREVIEWS_CONFIG.number;
            }
            else {
                num = obj.carouselPreviewsConfig.number;
            }
            if (obj.carouselPreviewsConfig.breakpoints) {
                breakpoints = Object.assign({}, DEFAULT_CONFIG.carouselPreviewsConfig.breakpoints, obj.carouselPreviewsConfig.breakpoints);
            }
            else {
                breakpoints = DEFAULT_CONFIG.carouselPreviewsConfig.breakpoints;
            }
            newConfig.carouselPreviewsConfig = Object.assign({}, DEFAULT_CONFIG.carouselPreviewsConfig, obj.carouselPreviewsConfig);
            newConfig.carouselPreviewsConfig.number = num;
            newConfig.carouselPreviewsConfig.breakpoints = breakpoints;
            // Init preview image width based on the number of previews in PreviewConfig
            // Don't move this line above, because I need to be sure that both configPreview.number
            // and configPreview.size are initialized
            newConfig.carouselPreviewsConfig.width = 100 / newConfig.carouselPreviewsConfig.number + '%';
        }
        if (obj.carouselDotsConfig) {
            newConfig.carouselDotsConfig = Object.assign({}, DEFAULT_CONFIG.carouselDotsConfig, obj.carouselDotsConfig);
        }
        if (obj.carouselSlideInfinite === undefined) {
            newConfig.carouselSlideInfinite = DEFAULT_CONFIG.carouselSlideInfinite;
        }
        else {
            newConfig.carouselSlideInfinite = obj.carouselSlideInfinite;
        }
        if (obj.enableCloseOutside === undefined) {
            newConfig.enableCloseOutside = DEFAULT_CONFIG.enableCloseOutside;
        }
        else {
            newConfig.enableCloseOutside = obj.enableCloseOutside;
        }
        if (obj.keyboardServiceConfig) {
            newConfig.keyboardServiceConfig = Object.assign({}, DEFAULT_KEYBOARD_SERVICE_CONFIG, obj.keyboardServiceConfig);
        }
        this.configMap.set(id, newConfig);
    }
    initIfNotExists(id) {
        if (!this.configMap.has(id)) {
            this.configMap.set(id, DEFAULT_CONFIG);
        }
    }
}
ConfigService.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.0.0", ngImport: i0, type: ConfigService, deps: [], target: i0.ɵɵFactoryTarget.Injectable });
ConfigService.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: "12.0.0", version: "13.0.0", ngImport: i0, type: ConfigService, providedIn: 'root' });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.0.0", ngImport: i0, type: ConfigService, decorators: [{
            type: Injectable,
            args: [{ providedIn: 'root' }]
        }] });
/**
 * Function to build and return a `PlainGalleryConfig` object, proving also default values and validating the input object.
 * @param plainGalleryConfig object with the config requested by user
 * @returns PlainGalleryConfig the plain gallery configuration
 * @throws an Error if layout and strategy aren't compatible
 */
function initPlainGalleryConfig(plainGalleryConfig) {
    const newPlayGalleryConfig = Object.assign({}, DEFAULT_CONFIG.plainGalleryConfig, plainGalleryConfig);
    if (newPlayGalleryConfig.layout instanceof LineLayout) {
        if (newPlayGalleryConfig.strategy !== PlainGalleryStrategy.ROW && newPlayGalleryConfig.strategy !== PlainGalleryStrategy.COLUMN) {
            throw new Error('LineLayout requires either ROW or COLUMN strategy');
        }
        if (!newPlayGalleryConfig.layout || !newPlayGalleryConfig.layout.breakConfig) {
            throw new Error('Both layout and breakConfig must be valid');
        }
    }
    if (newPlayGalleryConfig.layout instanceof GridLayout) {
        if (newPlayGalleryConfig.strategy !== PlainGalleryStrategy.GRID) {
            throw new Error('GridLayout requires GRID strategy');
        }
        if (!newPlayGalleryConfig.layout || !newPlayGalleryConfig.layout.breakConfig) {
            throw new Error('Both layout and breakConfig must be valid');
        }
        // force wrap for grid layout
        newPlayGalleryConfig.layout.breakConfig.wrap = true;
    }
    return newPlayGalleryConfig;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29uZmlnLnNlcnZpY2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9rczg5L2FuZ3VsYXItbW9kYWwtZ2FsbGVyeS9zcmMvbGliL3NlcnZpY2VzL2NvbmZpZy5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0dBc0JHO0FBRUgsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUczQyxPQUFPLEVBQUUsK0JBQStCLEVBQUUsTUFBTSxxQ0FBcUMsQ0FBQztBQUd0RixPQUFPLEVBQWlCLGVBQWUsRUFBRSxNQUFNLG1DQUFtQyxDQUFDO0FBRW5GLE9BQU8sRUFBRSxVQUFVLEVBQUUsVUFBVSxFQUFzQixvQkFBb0IsRUFBRSxNQUFNLHlDQUF5QyxDQUFDO0FBRTNILE9BQU8sRUFBaUIsV0FBVyxFQUFFLE1BQU0sbUNBQW1DLENBQUM7QUFDL0UsT0FBTyxFQUFlLG1CQUFtQixFQUFvQixNQUFNLGdDQUFnQyxDQUFDOztBQU9wRyxNQUFNLENBQUMsTUFBTSxvQkFBb0IsR0FBUyxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxDQUFDO0FBQzVFLE1BQU0sQ0FBQyxNQUFNLGNBQWMsR0FBZSxJQUFJLFVBQVUsQ0FBQyxvQkFBb0IsRUFBRSxFQUFFLE1BQU0sRUFBRSxDQUFDLENBQUMsRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLEVBQUUsWUFBWSxDQUFDLENBQUM7QUFDMUgsTUFBTSxDQUFDLE1BQU0sb0JBQW9CLEdBQXVCO0lBQ3RELFFBQVEsRUFBRSxvQkFBb0IsQ0FBQyxHQUFHO0lBQ2xDLE1BQU0sRUFBRSxjQUFjO0lBQ3RCLFFBQVEsRUFBRSxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsb0JBQW9CLEVBQUUsZUFBZSxFQUFFO0NBQ2xFLENBQUM7QUFDRixNQUFNLENBQUMsTUFBTSxlQUFlLEdB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TUFBTSxDQUFDLE1BQU0sQ0FBQyxFQUFFLEVBQUUsY0FBYyxDQUFDLGtCQUFrQixFQUFFLGtCQUFrQixDQUFDLENBQUM7SUFFMUgsSUFBSSxvQkFBb0IsQ0FBQyxNQUFNLFlBQVksVUFBVSxFQUFFO1FBQ3JELElBQUksb0JBQW9CLENBQUMsUUFBUSxLQUFLLG9CQUFvQixDQUFDLEdBQUcsSUFBSSxvQkFBb0IsQ0FBQyxRQUFRLEtBQUssb0JBQW9CLENBQUMsTUFBTSxFQUFFO1lBQy9ILE1BQU0sSUFBSSxLQUFLLENBQUMsbURBQW1ELENBQUMsQ0FBQztTQUN0RTtRQUNELElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxNQUFNLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxNQUFNLENBQUMsV0FBVyxFQUFFO1lBQzVFLE1BQU0sSUFBSSxLQUFLLENBQUMsMkNBQTJDLENBQUMsQ0FBQztTQUM5RDtLQUNGO0lBRUQsSUFBSSxvQkFBb0IsQ0FBQyxNQUFNLFlBQVksVUFBVSxFQUFFO1FBQ3JELElBQUksb0JBQW9CLENBQUMsUUFBUSxLQUFLLG9CQUFvQixDQUFDLElBQUksRUFBRTtZQUMvRCxNQUFNLElBQUksS0FBSyxDQUFDLG1DQUFtQyxDQUFDLENBQUM7U0FDdEQ7UUFDRCxJQUFJLENBQUMsb0JBQW9CLENBQUMsTUFBTSxJQUFJLENBQUMsb0JBQW9CLENBQUMsTUFBTSxDQUFDLFdBQVcsRUFBRTtZQUM1RSxNQUFNLElBQUksS0FBSyxDQUFDLDJDQUEyQyxDQUFDLENBQUM7U0FDOUQ7UUFDRCw2QkFBNkI7UUFDN0Isb0JBQW9CLENBQUMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDO0tBQ3JEO0lBQ0QsT0FBTyxvQkFBb0IsQ0FBQztBQUM5QixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiBUaGUgTUlUIExpY2Vuc2UgKE1JVClcblxuIENvcHlyaWdodCAoQykgMjAxNy0yMDIxIFN0ZWZhbm8gQ2FwcGEgKEtzODkpXG5cbiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcblxuIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbFxuIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG5cbiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTiBJTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFXG4gU09GVFdBUkUuXG4gKi9cblxuaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgU2lkZVByZXZpZXdzQ29uZmlnLCBTbGlkZUNvbmZpZyB9IGZyb20gJy4uL21vZGVsL3NsaWRlLWNvbmZpZy5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgUGxheUNvbmZpZyB9IGZyb20gJy4uL21vZGVsL3BsYXktY29uZmlnLmludGVyZmFjZSc7XG5pbXBvcnQgeyBLU19ERUZBVUxUX0FDQ0VTU0lCSUxJVFlfQ09ORklHIH0gZnJvbSAnLi4vY29tcG9uZW50cy9hY2Nlc3NpYmlsaXR5LWRlZmF1bHQnO1xuaW1wb3J0IHsgUHJldmlld0NvbmZpZyB9IGZyb20gJy4uL21vZGVsL3ByZXZpZXctY29uZmlnLmludGVyZmFjZSc7XG5pbXBvcnQgeyBTaXplIH0gZnJvbSAnLi4vbW9kZWwvc2l6ZS5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgQnV0dG9uc0NvbmZpZywgQnV0dG9uc1N0cmF0ZWd5IH0gZnJvbSAnLi4vbW9kZWwvYnV0dG9ucy1jb25maWcuaW50ZXJmYWNlJztcbmltcG9ydCB7IERvdHNDb25maWcgfSBmcm9tICcuLi9tb2RlbC9kb3RzLWNvbmZpZy5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgR3JpZExheW91dCwgTGluZUxheW91dCwgUGxhaW5HYWxsZXJ5Q29uZmlnLCBQbGFpbkdhbGxlcnlTdHJhdGVneSB9IGZyb20gJy4uL21vZGVsL3BsYWluLWdhbGxlcnktY29uZmlnLmludGVyZmFjZSc7XG5pbXBvcnQgeyBDdXJyZW50SW1hZ2VDb25maWcgfSBmcm9tICcuLi9tb2RlbC9jdXJyZW50LWltYWdlLWNvbmZpZy5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgTG9hZGluZ0NvbmZpZywgTG9hZGluZ1R5cGUgfSBmcm9tICcuLi9tb2RlbC9sb2FkaW5nLWNvbmZpZy5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgRGVzY3JpcHRpb24sIERlc2NyaXB0aW9uU3RyYXRlZ3ksIERlc2NyaXB0aW9uU3R5bGUgfSBmcm9tICcuLi9tb2RlbC9kZXNjcmlwdGlvbi5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgQ2Fyb3VzZWxDb25maWcgfSBmcm9tICcuLi9tb2RlbC9jYXJvdXNlbC1jb25maWcuaW50ZXJmYWNlJztcbmltcG9ydCB7IENhcm91c2VsSW1hZ2VDb25maWcgfSBmcm9tICcuLi9tb2RlbC9jYXJvdXNlbC1pbWFnZS1jb25maWcuaW50ZXJmYWNlJztcbmltcG9ydCB7IEJyZWFrcG9pbnRzQ29uZmlnLCBDYXJvdXNlbFByZXZpZXdDb25maWcgfSBmcm9tICcuLi9tb2RlbC9jYXJvdXNlbC1wcmV2aWV3LWNvbmZpZy5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgS2V5Ym9hcmRTZXJ2aWNlQ29uZmlnIH0gZnJvbSAnLi4vbW9kZWwva2V5Ym9hcmQtc2VydmljZS1jb25maWcuaW50ZXJmYWNlJztcbmltcG9ydCB7IExpYkNvbmZpZyB9IGZyb20gJy4uL21vZGVsL2xpYi1jb25maWcuaW50ZXJmYWNlJztcblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfUFJFVklFV19TSVpFOiBTaXplID0geyBoZWlnaHQ6ICc1MHB4Jywgd2lkdGg6ICdhdXRvJyB9O1xuZXhwb3J0IGNvbnN0IERFRkFVTFRfTEFZT1VUOiBMaW5lTGF5b3V0ID0gbmV3IExpbmVMYXlvdXQoREVGQVVMVF9QUkVWSUVXX1NJWkUsIHsgbGVuZ3RoOiAtMSwgd3JhcDogZmFsc2UgfSwgJ2ZsZXgtc3RhcnQnKTtcbmV4cG9ydCBjb25zdCBERUZBVUxUX1BMQUlOX0NPTkZJRzogUGxhaW5HYWxsZXJ5Q29uZmlnID0ge1xuICBzdHJhdGVneTogUGxhaW5HYWxsZXJ5U3RyYXRlZ3kuUk9XLFxuICBsYXlvdXQ6IERFRkFVTFRfTEFZT1VULFxuICBhZHZhbmNlZDogeyBhVGFnczogZmFsc2UsIGFkZGl0aW9uYWxCYWNrZ3JvdW5kOiAnNTAlIDUwJS9jb3ZlcicgfVxufTtcbmV4cG9ydCBjb25zdCBERUZBVUxUX0xPQURJTkc6IExvYWRpbmdDb25maWcgPSB7IGVuYWJsZTogdHJ1ZSwgdHlwZTogTG9hZGluZ1R5cGUuU1RBTkRBUkQgfTtcbmV4cG9ydCBjb25zdCBERUZBVUxUX0RFU0NSSVBUSU9OX1NUWUxFOiBEZXNjcmlwdGlvblN0eWxlID0ge1xuICBiZ0NvbG9yOiAncmdiYSgwLCAwLCAwLCAuNSknLFxuICB0ZXh0Q29sb3I6ICd3aGl0ZScsXG4gIG1hcmdpblRvcDogJzBweCcsXG4gIG1hcmdpbkJvdHRvbTogJzBweCcsXG4gIG1hcmdpbkxlZnQ6ICcwcHgnLFxuICBtYXJnaW5SaWdodDogJzBweCdcbn07XG5leHBvcnQgY29uc3QgREVGQVVMVF9ERVNDUklQVElPTjogRGVzY3JpcHRpb24gPSB7XG4gIHN0cmF0ZWd5OiBEZXNjcmlwdGlvblN0cmF0ZWd5LkFMV0FZU19WSVNJQkxFLFxuICBpbWFnZVRleHQ6ICdJbWFnZSAnLFxuICBudW1iZXJTZXBhcmF0b3I6ICcvJyxcbiAgYmVmb3JlVGV4dERlc2NyaXB0aW9uOiAnIC0gJyxcbiAgc3R5bGU6IERFRkFVTFRfREVTQ1JJUFRJT05fU1RZTEVcbn07XG5leHBvcnQgY29uc3QgREVGQVVMVF9DQVJPVVNFTF9ERVNDUklQVElPTjogRGVzY3JpcHRpb24gPSB7XG4gIHN0cmF0ZWd5OiBEZXNjcmlwdGlvblN0cmF0ZWd5LkFMV0FZU19ISURERU4sXG4gIGltYWdlVGV4dDogJ0ltYWdlICcsXG4gIG51bWJlclNlcGFyYXRvcjogJy8nLFxuICBiZWZvcmVUZXh0RGVzY3JpcHRpb246ICcgLSAnLFxuICBzdHlsZTogREVGQVVMVF9ERVNDUklQVElPTl9TVFlMRVxufTtcbmV4cG9ydCBjb25zdCBERUZBVUxUX0NVUlJFTlRfSU1BR0VfQ09ORklHOiBDdXJyZW50SW1hZ2VDb25maWcgPSB7XG4gIG5hdmlnYXRlT25DbGljazogdHJ1ZSxcbiAgbG9hZGluZ0NvbmZpZzogREVGQVVMVF9MT0FESU5HLFxuICBkZXNjcmlwdGlvbjogREVGQVVMVF9ERVNDUklQVElPTixcbiAgZG93bmxvYWRhYmxlOiBmYWxzZSxcbiAgaW52ZXJ0U3dpcGU6IGZhbHNlXG59O1xuZXhwb3J0IGNvbnN0IERFRkFVTFRfQ0FST1VTRUxfSU1BR0VfQ09ORklHOiBDYXJvdXNlbEltYWdlQ29uZmlnID0ge1xuICBkZXNjcmlwdGlvbjogREVGQVVMVF9DQVJPVVNFTF9ERVNDUklQVElPTixcbiAgaW52ZXJ0U3dpcGU6IGZhbHNlXG59O1xuZXhwb3J0IGNvbnN0IERFRkFVTFRfQ1VSUkVOVF9DQVJPVVNFTF9DT05GSUc6IENhcm91c2VsQ29uZmlnID0ge1xuICBtYXhXaWR0aDogJzEwMCUnLFxuICBtYXhIZWlnaHQ6ICc0MDBweCcsXG4gIHNob3dBcnJvd3M6IHRydWUsXG4gIG9iamVjdEZpdDogJ2NvdmVyJyxcbiAga2V5Ym9hcmRFbmFibGU6IHRydWUsXG4gIG1vZGFsR2FsbGVyeUVuYWJsZTogZmFsc2Vcbn07XG5leHBvcnQgY29uc3QgREVGQVVMVF9DVVJSRU5UX0NBUk9VU0VMX1BMQVk6IFBsYXlDb25maWcgPSB7XG4gIGF1dG9QbGF5OiB0cnVlLFxuICBpbnRlcnZhbDogNTAwMCxcbiAgcGF1c2VPbkhvdmVyOiB0cnVlXG59O1xuXG5leHBvcnQgY29uc3QgREVGQVVMVF9DQVJPVVNFTF9CUkVBS1BPSU5UUzogQnJlYWtwb2ludHNDb25maWcgPSB7IHhTbWFsbDogMTAwLCBzbWFsbDogMTAwLCBtZWRpdW06IDE1MCwgbGFyZ2U6IDIwMCwgeExhcmdlOiAyMDAgfTtcbmV4cG9ydCBjb25zdCBERUZBVUxUX0NBUk9VU0VMX1BSRVZJRVdTX0NPTkZJRzogQ2Fyb3VzZWxQcmV2aWV3Q29uZmlnID0ge1xuICB2aXNpYmxlOiB0cnVlLFxuICBudW1iZXI6IDQsXG4gIGFycm93czogdHJ1ZSxcbiAgY2xpY2thYmxlOiB0cnVlLFxuICB3aWR0aDogMTAwIC8gNCArICclJyxcbiAgbWF4SGVpZ2h0OiAnMjAwcHgnLFxuICBicmVha3BvaW50czogREVGQVVMVF9DQVJPVVNFTF9CUkVBS1BPSU5UU1xufTtcbmV4cG9ydCBjb25zdCBERUZBVUxUX0tFWUJPQVJEX1NFUlZJQ0VfQ09ORklHOiBLZXlib2FyZFNlcnZpY2VDb25maWcgPSB7XG4gIHNob3J0Y3V0czogWydjdHJsK3MnLCAnbWV0YStzJ10sXG4gIGRpc2FibGVTc3JXb3JrYXJvdW5kOiBmYWxzZVxufTtcbmV4cG9ydCBjb25zdCBERUZBVUxUX1NMSURFX0NPTkZJRzogU2xpZGVDb25maWcgPSB7XG4gIGluZmluaXRlOiBmYWxzZSxcbiAgcGxheUNvbmZpZzogeyBhdXRvUGxheTogZmFsc2UsIGludGVydmFsOiA1MDAwLCBwYXVzZU9uSG92ZXI6IHRydWUgfSBhcyBQbGF5Q29uZmlnLFxuICBzaWRlUHJldmlld3M6IHsgc2hvdzogdHJ1ZSwgc2l6ZTogeyB3aWR0aDogJzEwMHB4JywgaGVpZ2h0OiAnYXV0bycgfSB9IGFzIFNpZGVQcmV2aWV3c0NvbmZpZ1xufTtcbmV4cG9ydCBjb25zdCBERUZBVUxUX1BSRVZJRVdfQ09ORklHOiBQcmV2aWV3Q29uZmlnID0ge1xuICB2aXNpYmxlOiB0cnVlLFxuICBudW1iZXI6IDMsXG4gIGFycm93czogdHJ1ZSxcbiAgY2xpY2thYmxlOiB0cnVlLFxuICBzaXplOiBERUZBVUxUX1BSRVZJRVdfU0laRVxufTtcblxuY29uc3QgREVGQVVMVF9DT05GSUc6IExpYkNvbmZpZyA9IE9iamVjdC5mcmVlemUoe1xuICBzbGlkZUNvbmZpZzogREVGQVVMVF9TTElERV9DT05GSUcsXG4gIGFjY2Vzc2liaWxpdHlDb25maWc6IEtTX0RFRkFVTFRfQUNDRVNTSUJJTElUWV9DT05GSUcsXG4gIHByZXZpZXdDb25maWc6IERFRkFVTFRfUFJFVklFV19DT05GSUcsXG4gIGJ1dHRvbnNDb25maWc6IHsgdmlzaWJsZTogdHJ1ZSwgc3RyYXRlZ3k6IEJ1dHRvbnNTdHJhdGVneS5ERUZBVUxUIH0gYXMgQnV0dG9uc0NvbmZpZyxcbiAgZG90c0NvbmZpZzogeyB2aXNpYmxlOiB0cnVlIH0gYXMgRG90c0NvbmZpZyxcbiAgcGxhaW5HYWxsZXJ5Q29uZmlnOiBERUZBVUxUX1BMQUlOX0NPTkZJRyxcbiAgY3VycmVudEltYWdlQ29uZmlnOiBERUZBVUxUX0NVUlJFTlRfSU1BR0VfQ09ORklHLFxuICBrZXlib2FyZENvbmZpZzogdW5kZWZpbmVkLCAvLyBieSBkZWZhdWx0IG5vdGhpbmcsIGJlY2F1c2UgdGhlIGxpYnJhcnkgdXNlcyBkZWZhdWx0IGJ1dHRvbnMgYXV0b21hdGljYWxseVxuICBjYXJvdXNlbENvbmZpZzogREVGQVVMVF9DVVJSRU5UX0NBUk9VU0VMX0NPTkZJRyxcbiAgY2Fyb3VzZWxJbWFnZUNvbmZpZzogREVGQVVMVF9DQVJPVVNFTF9JTUFHRV9DT05GSUcsXG4gIGNhcm91c2VsUHJldmlld3NDb25maWc6IERFRkFVTFRfQ0FST1VTRUxfUFJFVklFV1NfQ09ORklHLFxuICBjYXJvdXNlbFBsYXlDb25maWc6IERFRkFVTFRfQ1VSUkVOVF9DQVJPVVNFTF9QTEFZLFxuICBjYXJvdXNlbERvdHNDb25maWc6IHsgdmlzaWJsZTogdHJ1ZSB9IGFzIERvdHNDb25maWcsXG4gIGNhcm91c2VsU2xpZGVJbmZpbml0ZTogdHJ1ZSxcbiAgZW5hYmxlQ2xvc2VPdXRzaWRlOiB0cnVlLFxuICBrZXlib2FyZFNlcnZpY2VDb25maWc6IERFRkFVTFRfS0VZQk9BUkRfU0VSVklDRV9DT05GSUdcbn0pO1xuXG4vKipcbiAqIFNlcnZpY2UgdG8gaGFuZGxlIGxpYnJhcnkgY29uZmlndXJhdGlvbiBpbiBhIHVuaXF1ZSBwbGFjZVxuICovXG5ASW5qZWN0YWJsZSh7IHByb3ZpZGVkSW46ICdyb290JyB9KVxuZXhwb3J0IGNsYXNzIENvbmZpZ1NlcnZpY2Uge1xuICBjb25maWdNYXA6IE1hcDxudW1iZXIsIExpYkNvbmZpZz4gPSBuZXcgTWFwPG51bWJlciwgTGliQ29uZmlnPigpO1xuXG4gIGdldENvbmZpZyhpZDogbnVtYmVyKTogTGliQ29uZmlnIHwgdW5kZWZpbmVkIHtcbiAgICB0aGlzLmluaXRJZk5vdEV4aXN0cyhpZCk7XG4gICAgcmV0dXJuIHRoaXMuY29uZmlnTWFwLmdldChpZCk7XG4gIH1cblxuICBzZXRDb25maWcoaWQ6IG51bWJlciwgb2JqOiBMaWJDb25maWcgfCB1bmRlZmluZWQpOiB2b2lkIHtcbiAgICB0aGlzLmluaXRJZk5vdEV4aXN0cyhpZCk7XG4gICAgaWYgKCFvYmopIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoXG4gICAgICAhREVGQVVMVF9DT05GSUcgfHxcbiAgICAgICFERUZBVUxUX0NPTkZJRy5zbGlkZUNvbmZpZyB8fFxuICAgICAgIURFRkFVTFRfQ09ORklHLnNsaWRlQ29uZmlnLnNpZGVQcmV2aWV3cyB8fFxuICAgICAgIURFRkFVTFRfQ09ORklHLnByZXZpZXdDb25maWcgfHxcbiAgICAgICFERUZBVUxUX0NPTkZJRy5wcmV2aWV3Q29uZmlnLnNpemUgfHxcbiAgICAgICFERUZBVUxUX0NPTkZJRy5wcmV2aWV3Q29uZmlnLm51bWJlciB8fFxuICAgICAgIURFRkFVTFRfQ09ORklHLnBsYWluR2FsbGVyeUNvbmZpZyB8fFxuICAgICAgIURFRkFVTFRfQ09ORklHLmN1cnJlbnRJbWFnZUNvbmZpZyB8fFxuICAgICAgIURFRkFVTFRfQ09ORklHLmN1cnJlbnRJbWFnZUNvbmZpZyB8fFxuICAgICAgIURFRkFVTFRfQ09ORklHLmN1cnJlbnRJbWFnZUNvbmZpZy5kZXNjcmlwdGlvbiB8fFxuICAgICAgIURFRkFVTFRfQ09ORklHLmNhcm91c2VsSW1hZ2VDb25maWcgfHxcbiAgICAgICFERUZBVUxUX0NPTkZJRy5jYXJvdXNlbEltYWdlQ29uZmlnLmRlc2NyaXB0aW9uIHx8XG4gICAgICAhREVGQVVMVF9DT05GSUcuY2Fyb3VzZWxQcmV2aWV3c0NvbmZpZyB8fFxuICAgICAgIURFRkFVTFRfQ09ORklHLmNhcm91c2VsUHJldmlld3NDb25maWcuYnJlYWtwb2ludHMgfHxcbiAgICAgICFERUZBVUxUX0NBUk9VU0VMX1BSRVZJRVdTX0NPTkZJRy5udW1iZXJcbiAgICApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW50ZXJuYWwgbGlicmFyeSBlcnJvciAtIERFRkFVTFRfQ09ORklHIG11c3QgYmUgZnVsbHkgaW5pdGlhbGl6ZWQhISEnKTtcbiAgICB9XG5cbiAgICBjb25zdCBuZXdDb25maWc6IExpYkNvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIHRoaXMuY29uZmlnTWFwLmdldChpZCkpO1xuICAgIGlmIChvYmouc2xpZGVDb25maWcpIHtcbiAgICAgIGxldCBwbGF5Q29uZmlnO1xuICAgICAgbGV0IHNpZGVQcmV2aWV3cztcbiAgICAgIGxldCBzaXplO1xuICAgICAgaWYgKG9iai5zbGlkZUNvbmZpZy5wbGF5Q29uZmlnKSB7XG4gICAgICAgIHBsYXlDb25maWcgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX0NPTkZJRy5zbGlkZUNvbmZpZy5wbGF5Q29uZmlnLCBvYmouc2xpZGVDb25maWcucGxheUNvbmZpZyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwbGF5Q29uZmlnID0gREVGQVVMVF9DT05GSUcuc2xpZGVDb25maWcucGxheUNvbmZpZztcbiAgICAgIH1cbiAgICAgIGlmIChvYmouc2xpZGVDb25maWcuc2lkZVByZXZpZXdzKSB7XG4gICAgICAgIGlmIChvYmouc2xpZGVDb25maWcuc2lkZVByZXZpZXdzLnNpemUpIHtcbiAgICAgICAgICBzaXplID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9DT05GSUcuc2xpZGVDb25maWcuc2lkZVByZXZpZXdzLnNpemUsIG9iai5zbGlkZUNvbmZpZy5zaWRlUHJldmlld3Muc2l6ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2l6ZSA9IERFRkFVTFRfQ09ORklHLnNsaWRlQ29uZmlnLnNpZGVQcmV2aWV3cy5zaXplO1xuICAgICAgICB9XG4gICAgICAgIHNpZGVQcmV2aWV3cyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfQ09ORklHLnNsaWRlQ29uZmlnLnNpZGVQcmV2aWV3cywgb2JqLnNsaWRlQ29uZmlnLnNpZGVQcmV2aWV3cyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzaWRlUHJldmlld3MgPSBERUZBVUxUX0NPTkZJRy5zbGlkZUNvbmZpZy5zaWRlUHJldmlld3M7XG4gICAgICAgIHNpemUgPSBERUZBVUxUX0NPTkZJRy5zbGlkZUNvbmZpZy5zaWRlUHJldmlld3Muc2l6ZTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IG5ld1NsaWRlQ29uZmlnOiBTbGlkZUNvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfQ09ORklHLnNsaWRlQ29uZmlnLCBvYmouc2xpZGVDb25maWcpO1xuICAgICAgbmV3U2xpZGVDb25maWcucGxheUNvbmZpZyA9IHBsYXlDb25maWc7XG4gICAgICBuZXdTbGlkZUNvbmZpZy5zaWRlUHJldmlld3MgPSBzaWRlUHJldmlld3M7XG4gICAgICBuZXdTbGlkZUNvbmZpZy5zaWRlUHJldmlld3Muc2l6ZSA9IHNpemU7XG4gICAgICBuZXdDb25maWcuc2xpZGVDb25maWcgPSBuZXdTbGlkZUNvbmZpZztcbiAgICB9XG4gICAgaWYgKG9iai5hY2Nlc3NpYmlsaXR5Q29uZmlnKSB7XG4gICAgICBuZXdDb25maWcuYWNjZXNzaWJpbGl0eUNvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfQ09ORklHLmFjY2Vzc2liaWxpdHlDb25maWcsIG9iai5hY2Nlc3NpYmlsaXR5Q29uZmlnKTtcbiAgICB9XG4gICAgaWYgKG9iai5wcmV2aWV3Q29uZmlnKSB7XG4gICAgICBsZXQgc2l6ZTogU2l6ZTtcbiAgICAgIGxldCBudW06IG51bWJlcjtcbiAgICAgIGlmIChvYmoucHJldmlld0NvbmZpZy5zaXplKSB7XG4gICAgICAgIHNpemUgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX0NPTkZJRy5wcmV2aWV3Q29uZmlnLnNpemUsIG9iai5wcmV2aWV3Q29uZmlnLnNpemUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2l6ZSA9IERFRkFVTFRfQ09ORklHLnByZXZpZXdDb25maWcuc2l6ZTtcbiAgICAgIH1cbiAgICAgIGlmIChvYmoucHJldmlld0NvbmZpZy5udW1iZXIpIHtcbiAgICAgICAgaWYgKG9iai5wcmV2aWV3Q29uZmlnLm51bWJlciA8PSAwKSB7XG4gICAgICAgICAgLy8gaWYgbnVtYmVyIGlzIDw9IDAgcmVzZXQgdG8gZGVmYXVsdFxuICAgICAgICAgIG51bSA9IERFRkFVTFRfQ09ORklHLnByZXZpZXdDb25maWcubnVtYmVyO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG51bSA9IG9iai5wcmV2aWV3Q29uZmlnLm51bWJlcjtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbnVtID0gREVGQVVMVF9DT05GSUcucHJldmlld0NvbmZpZy5udW1iZXI7XG4gICAgICB9XG4gICAgICBjb25zdCBuZXdQcmV2aWV3Q29uZmlnOiBQcmV2aWV3Q29uZmlnID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9DT05GSUcucHJldmlld0NvbmZpZywgb2JqLnByZXZpZXdDb25maWcpO1xuICAgICAgbmV3UHJldmlld0NvbmZpZy5zaXplID0gc2l6ZTtcbiAgICAgIG5ld1ByZXZpZXdDb25maWcubnVtYmVyID0gbnVtO1xuICAgICAgbmV3Q29uZmlnLnByZXZpZXdDb25maWcgPSBuZXdQcmV2aWV3Q29uZmlnO1xuICAgIH1cbiAgICBpZiAob2JqLmJ1dHRvbnNDb25maWcpIHtcbiAgICAgIG5ld0NvbmZpZy5idXR0b25zQ29uZmlnID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9DT05GSUcuYnV0dG9uc0NvbmZpZywgb2JqLmJ1dHRvbnNDb25maWcpO1xuICAgIH1cbiAgICBpZiAob2JqLmRvdHNDb25maWcpIHtcbiAgICAgIG5ld0NvbmZpZy5kb3RzQ29uZmlnID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9DT05GSUcuZG90c0NvbmZpZywgb2JqLmRvdHNDb25maWcpO1xuICAgIH1cbiAgICBpZiAob2JqLnBsYWluR2FsbGVyeUNvbmZpZykge1xuICAgICAgbGV0IGFkdmFuY2VkO1xuICAgICAgbGV0IGxheW91dDtcbiAgICAgIGlmIChvYmoucGxhaW5HYWxsZXJ5Q29uZmlnLmFkdmFuY2VkKSB7XG4gICAgICAgIGFkdmFuY2VkID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9DT05GSUcucGxhaW5HYWxsZXJ5Q29uZmlnLmFkdmFuY2VkLCBvYmoucGxhaW5HYWxsZXJ5Q29uZmlnLmFkdmFuY2VkKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGFkdmFuY2VkID0gREVGQVVMVF9DT05GSUcucGxhaW5HYWxsZXJ5Q29uZmlnLmFkdmFuY2VkO1xuICAgICAgfVxuICAgICAgaWYgKG9iai5wbGFpbkdhbGxlcnlDb25maWcubGF5b3V0KSB7XG4gICAgICAgIC8vIGl0IGlzbid0IG1hbmRhdG9yeSB0byB1c2UgYXNzaWduLCBiZWNhdXNlIG9iai5wbGFpbkdhbGxlcnlDb25maWcubGF5b3V0IGlzIGFuIGluc3RhbmNlIG9mIGNsYXNzIChMaW5lYUxheW91dCwgR3JpZExheW91dClcbiAgICAgICAgbGF5b3V0ID0gb2JqLnBsYWluR2FsbGVyeUNvbmZpZy5sYXlvdXQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBsYXlvdXQgPSBERUZBVUxUX0NPTkZJRy5wbGFpbkdhbGxlcnlDb25maWcubGF5b3V0O1xuICAgICAgfVxuICAgICAgY29uc3QgbmV3UGxhaW5HYWxsZXJ5Q29uZmlnOiBQbGFpbkdhbGxlcnlDb25maWcgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX0NPTkZJRy5wbGFpbkdhbGxlcnlDb25maWcsIG9iai5wbGFpbkdhbGxlcnlDb25maWcpO1xuICAgICAgbmV3UGxhaW5HYWxsZXJ5Q29uZmlnLmxheW91dCA9IGxheW91dDtcbiAgICAgIG5ld1BsYWluR2FsbGVyeUNvbmZpZy5hZHZhbmNlZCA9IGFkdmFuY2VkO1xuICAgICAgbmV3Q29uZmlnLnBsYWluR2FsbGVyeUNvbmZpZyA9IGluaXRQbGFpbkdhbGxlcnlDb25maWcobmV3UGxhaW5HYWxsZXJ5Q29uZmlnKTtcbiAgICB9XG4gICAgaWYgKG9iai5jdXJyZW50SW1hZ2VDb25maWcpIHtcbiAgICAgIGxldCBsb2FkaW5nO1xuICAgICAgbGV0IGRlc2NyaXB0aW9uO1xuICAgICAgbGV0IGRlc2NyaXB0aW9uU3R5bGU7XG4gICAgICBpZiAob2JqLmN1cnJlbnRJbWFnZUNvbmZpZy5sb2FkaW5nQ29uZmlnKSB7XG4gICAgICAgIGxvYWRpbmcgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX0NPTkZJRy5jdXJyZW50SW1hZ2VDb25maWcubG9hZGluZ0NvbmZpZywgb2JqLmN1cnJlbnRJbWFnZUNvbmZpZy5sb2FkaW5nQ29uZmlnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxvYWRpbmcgPSBERUZBVUxUX0NPTkZJRy5jdXJyZW50SW1hZ2VDb25maWcubG9hZGluZ0NvbmZpZztcbiAgICAgIH1cbiAgICAgIGlmIChvYmouY3VycmVudEltYWdlQ29uZmlnLmRlc2NyaXB0aW9uKSB7XG4gICAgICAgIGRlc2NyaXB0aW9uID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9DT05GSUcuY3VycmVudEltYWdlQ29uZmlnLmRlc2NyaXB0aW9uLCBvYmouY3VycmVudEltYWdlQ29uZmlnLmRlc2NyaXB0aW9uKTtcbiAgICAgICAgaWYgKG9iai5jdXJyZW50SW1hZ2VDb25maWcuZGVzY3JpcHRpb24uc3R5bGUpIHtcbiAgICAgICAgICBkZXNjcmlwdGlvblN0eWxlID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9DT05GSUcuY3VycmVudEltYWdlQ29uZmlnLmRlc2NyaXB0aW9uLnN0eWxlLCBvYmouY3VycmVudEltYWdlQ29uZmlnLmRlc2NyaXB0aW9uLnN0eWxlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBkZXNjcmlwdGlvblN0eWxlID0gREVGQVVMVF9DT05GSUcuY3VycmVudEltYWdlQ29uZmlnLmRlc2NyaXB0aW9uLnN0eWxlO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBkZXNjcmlwdGlvbiA9IERFRkFVTFRfQ09ORklHLmN1cnJlbnRJbWFnZUNvbmZpZy5kZXNjcmlwdGlvbjtcbiAgICAgICAgZGVzY3JpcHRpb25TdHlsZSA9IERFRkFVTFRfQ09ORklHLmN1cnJlbnRJbWFnZUNvbmZpZy5kZXNjcmlwdGlvbi5zdHlsZTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IG5ld0N1cnJlbnRJbWFnZUNvbmZpZzogQ3VycmVudEltYWdlQ29uZmlnID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9DT05GSUcuY3VycmVudEltYWdlQ29uZmlnLCBvYmouY3VycmVudEltYWdlQ29uZmlnKTtcbiAgICAgIG5ld0N1cnJlbnRJbWFnZUNvbmZpZy5sb2FkaW5nQ29uZmlnID0gbG9hZGluZztcbiAgICAgIG5ld0N1cnJlbnRJbWFnZUNvbmZpZy5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xuICAgICAgbmV3Q3VycmVudEltYWdlQ29uZmlnLmRlc2NyaXB0aW9uLnN0eWxlID0gZGVzY3JpcHRpb25TdHlsZTtcbiAgICAgIG5ld0NvbmZpZy5jdXJyZW50SW1hZ2VDb25maWcgPSBuZXdDdXJyZW50SW1hZ2VDb25maWc7XG4gICAgfVxuICAgIGlmIChvYmoua2V5Ym9hcmRDb25maWcpIHtcbiAgICAgIG5ld0NvbmZpZy5rZXlib2FyZENvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfQ09ORklHLmtleWJvYXJkQ29uZmlnLCBvYmoua2V5Ym9hcmRDb25maWcpO1xuICAgIH1cblxuICAgIC8vIGNhcm91c2VsXG4gICAgaWYgKG9iai5jYXJvdXNlbENvbmZpZykge1xuICAgICAgbmV3Q29uZmlnLmNhcm91c2VsQ29uZmlnID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9DT05GSUcuY2Fyb3VzZWxDb25maWcsIG9iai5jYXJvdXNlbENvbmZpZyk7XG4gICAgfVxuICAgIGlmIChvYmouY2Fyb3VzZWxJbWFnZUNvbmZpZykge1xuICAgICAgbGV0IGRlc2NyaXB0aW9uO1xuICAgICAgbGV0IGRlc2NyaXB0aW9uU3R5bGU7XG4gICAgICBpZiAob2JqLmNhcm91c2VsSW1hZ2VDb25maWcuZGVzY3JpcHRpb24pIHtcbiAgICAgICAgZGVzY3JpcHRpb24gPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX0NPTkZJRy5jYXJvdXNlbEltYWdlQ29uZmlnLmRlc2NyaXB0aW9uLCBvYmouY2Fyb3VzZWxJbWFnZUNvbmZpZy5kZXNjcmlwdGlvbik7XG4gICAgICAgIGlmIChvYmouY2Fyb3VzZWxJbWFnZUNvbmZpZy5kZXNjcmlwdGlvbi5zdHlsZSkge1xuICAgICAgICAgIGRlc2NyaXB0aW9uU3R5bGUgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX0NPTkZJRy5jYXJvdXNlbEltYWdlQ29uZmlnLmRlc2NyaXB0aW9uLnN0eWxlLCBvYmouY2Fyb3VzZWxJbWFnZUNvbmZpZy5kZXNjcmlwdGlvbi5zdHlsZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZGVzY3JpcHRpb25TdHlsZSA9IERFRkFVTFRfQ09ORklHLmNhcm91c2VsSW1hZ2VDb25maWcuZGVzY3JpcHRpb24uc3R5bGU7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGRlc2NyaXB0aW9uID0gREVGQVVMVF9DT05GSUcuY2Fyb3VzZWxJbWFnZUNvbmZpZy5kZXNjcmlwdGlvbjtcbiAgICAgICAgZGVzY3JpcHRpb25TdHlsZSA9IERFRkFVTFRfQ09ORklHLmNhcm91c2VsSW1hZ2VDb25maWcuZGVzY3JpcHRpb24uc3R5bGU7XG4gICAgICB9XG4gICAgICBjb25zdCBuZXdDYXJvdXNlbEltYWdlQ29uZmlnOiBDYXJvdXNlbEltYWdlQ29uZmlnID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9DT05GSUcuY2Fyb3VzZWxJbWFnZUNvbmZpZywgb2JqLmNhcm91c2VsSW1hZ2VDb25maWcpO1xuICAgICAgbmV3Q2Fyb3VzZWxJbWFnZUNvbmZpZy5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xuICAgICAgbmV3Q2Fyb3VzZWxJbWFnZUNvbmZpZy5kZXNjcmlwdGlvbi5zdHlsZSA9IGRlc2NyaXB0aW9uU3R5bGU7XG4gICAgICBuZXdDb25maWcuY2Fyb3VzZWxJbWFnZUNvbmZpZyA9IG5ld0Nhcm91c2VsSW1hZ2VDb25maWc7XG4gICAgfVxuICAgIGlmIChvYmouY2Fyb3VzZWxQbGF5Q29uZmlnKSB7XG4gICAgICAvLyBjaGVjayB2YWx1ZXNcbiAgICAgIGlmIChvYmouY2Fyb3VzZWxQbGF5Q29uZmlnLmludGVydmFsIDw9IDApIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDYXJvdXNlbCdzIGludGVydmFsIG11c3QgYmUgYSBudW1iZXIgPj0gMGApO1xuICAgICAgfVxuICAgICAgbmV3Q29uZmlnLmNhcm91c2VsUGxheUNvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfQ09ORklHLmNhcm91c2VsUGxheUNvbmZpZywgb2JqLmNhcm91c2VsUGxheUNvbmZpZyk7XG4gICAgfVxuICAgIGlmIChvYmouY2Fyb3VzZWxQcmV2aWV3c0NvbmZpZykge1xuICAgICAgLy8gY2hlY2sgdmFsdWVzXG4gICAgICBsZXQgbnVtOiBudW1iZXI7XG4gICAgICBsZXQgYnJlYWtwb2ludHM6IEJyZWFrcG9pbnRzQ29uZmlnO1xuICAgICAgaWYgKCFvYmouY2Fyb3VzZWxQcmV2aWV3c0NvbmZpZy5udW1iZXIgfHwgb2JqLmNhcm91c2VsUHJldmlld3NDb25maWcubnVtYmVyIDw9IDApIHtcbiAgICAgICAgbnVtID0gREVGQVVMVF9DQVJPVVNFTF9QUkVWSUVXU19DT05GSUcubnVtYmVyO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbnVtID0gb2JqLmNhcm91c2VsUHJldmlld3NDb25maWcubnVtYmVyO1xuICAgICAgfVxuICAgICAgaWYgKG9iai5jYXJvdXNlbFByZXZpZXdzQ29uZmlnLmJyZWFrcG9pbnRzKSB7XG4gICAgICAgIGJyZWFrcG9pbnRzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9DT05GSUcuY2Fyb3VzZWxQcmV2aWV3c0NvbmZpZy5icmVha3BvaW50cywgb2JqLmNhcm91c2VsUHJldmlld3NDb25maWcuYnJlYWtwb2ludHMpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYnJlYWtwb2ludHMgPSBERUZBVUxUX0NPTkZJRy5jYXJvdXNlbFByZXZpZXdzQ29uZmlnLmJyZWFrcG9pbnRzO1xuICAgICAgfVxuICAgICAgbmV3Q29uZmlnLmNhcm91c2VsUHJldmlld3NDb25maWcgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX0NPTkZJRy5jYXJvdXNlbFByZXZpZXdzQ29uZmlnLCBvYmouY2Fyb3VzZWxQcmV2aWV3c0NvbmZpZyk7XG4gICAgICBuZXdDb25maWcuY2Fyb3VzZWxQcmV2aWV3c0NvbmZpZy5udW1iZXIgPSBudW07XG4gICAgICBuZXdDb25maWcuY2Fyb3VzZWxQcmV2aWV3c0NvbmZpZy5icmVha3BvaW50cyA9IGJyZWFrcG9pbnRzO1xuICAgICAgLy8gSW5pdCBwcmV2aWV3IGltYWdlIHdpZHRoIGJhc2VkIG9uIHRoZSBudW1iZXIgb2YgcHJldmlld3MgaW4gUHJldmlld0NvbmZpZ1xuICAgICAgLy8gRG9uJ3QgbW92ZSB0aGlzIGxpbmUgYWJvdmUsIGJlY2F1c2UgSSBuZWVkIHRvIGJlIHN1cmUgdGhhdCBib3RoIGNvbmZpZ1ByZXZpZXcubnVtYmVyXG4gICAgICAvLyBhbmQgY29uZmlnUHJldmlldy5zaXplIGFyZSBpbml0aWFsaXplZFxuICAgICAgbmV3Q29uZmlnLmNhcm91c2VsUHJldmlld3NDb25maWcud2lkdGggPSAxMDAgLyBuZXdDb25maWcuY2Fyb3VzZWxQcmV2aWV3c0NvbmZpZy5udW1iZXIgKyAnJSc7XG4gICAgfVxuICAgIGlmIChvYmouY2Fyb3VzZWxEb3RzQ29uZmlnKSB7XG4gICAgICBuZXdDb25maWcuY2Fyb3VzZWxEb3RzQ29uZmlnID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9DT05GSUcuY2Fyb3VzZWxEb3RzQ29uZmlnLCBvYmouY2Fyb3VzZWxEb3RzQ29uZmlnKTtcbiAgICB9XG4gICAgaWYgKG9iai5jYXJvdXNlbFNsaWRlSW5maW5pdGUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgbmV3Q29uZmlnLmNhcm91c2VsU2xpZGVJbmZpbml0ZSA9IERFRkFVTFRfQ09ORklHLmNhcm91c2VsU2xpZGVJbmZpbml0ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgbmV3Q29uZmlnLmNhcm91c2VsU2xpZGVJbmZpbml0ZSA9IG9iai5jYXJvdXNlbFNsaWRlSW5maW5pdGU7XG4gICAgfVxuICAgIGlmIChvYmouZW5hYmxlQ2xvc2VPdXRzaWRlID09PSB1bmRlZmluZWQpIHtcbiAgICAgIG5ld0NvbmZpZy5lbmFibGVDbG9zZU91dHNpZGUgPSBERUZBVUxUX0NPTkZJRy5lbmFibGVDbG9zZU91dHNpZGU7XG4gICAgfSBlbHNlIHtcbiAgICAgIG5ld0NvbmZpZy5lbmFibGVDbG9zZU91dHNpZGUgPSBvYmouZW5hYmxlQ2xvc2VPdXRzaWRlO1xuICAgIH1cbiAgICBpZiAob2JqLmtleWJvYXJkU2VydmljZUNvbmZpZykge1xuICAgICAgbmV3Q29uZmlnLmtleWJvYXJkU2VydmljZUNvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfS0VZQk9BUkRfU0VSVklDRV9DT05GSUcsIG9iai5rZXlib2FyZFNlcnZpY2VDb25maWcpO1xuICAgIH1cbiAgICB0aGlzLmNvbmZpZ01hcC5zZXQoaWQsIG5ld0NvbmZpZyk7XG4gIH1cblxuICBwcml2YXRlIGluaXRJZk5vdEV4aXN0cyhpZDogbnVtYmVyKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmNvbmZpZ01hcC5oYXMoaWQpKSB7XG4gICAgICB0aGlzLmNvbmZpZ01hcC5zZXQoaWQsIERFRkFVTFRfQ09ORklHKTtcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBGdW5jdGlvbiB0byBidWlsZCBhbmQgcmV0dXJuIGEgYFBsYWluR2FsbGVyeUNvbmZpZ2Agb2JqZWN0LCBwcm92aW5nIGFsc28gZGVmYXVsdCB2YWx1ZXMgYW5kIHZhbGlkYXRpbmcgdGhlIGlucHV0IG9iamVjdC5cbiAqIEBwYXJhbSBwbGFpbkdhbGxlcnlDb25maWcgb2JqZWN0IHdpdGggdGhlIGNvbmZpZyByZXF1ZXN0ZWQgYnkgdXNlclxuICogQHJldHVybnMgUGxhaW5HYWxsZXJ5Q29uZmlnIHRoZSBwbGFpbiBnYWxsZXJ5IGNvbmZpZ3VyYXRpb25cbiAqIEB0aHJvd3MgYW4gRXJyb3IgaWYgbGF5b3V0IGFuZCBzdHJhdGVneSBhcmVuJ3QgY29tcGF0aWJsZVxuICovXG5mdW5jdGlvbiBpbml0UGxhaW5HYWxsZXJ5Q29uZmlnKHBsYWluR2FsbGVyeUNvbmZpZzogUGxhaW5HYWxsZXJ5Q29uZmlnKTogUGxhaW5HYWxsZXJ5Q29uZmlnIHtcbiAgY29uc3QgbmV3UGxheUdhbGxlcnlDb25maWc6IFBsYWluR2FsbGVyeUNvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfQ09ORklHLnBsYWluR2FsbGVyeUNvbmZpZywgcGxhaW5HYWxsZXJ5Q29uZmlnKTtcblxuICBpZiAobmV3UGxheUdhbGxlcnlDb25maWcubGF5b3V0IGluc3RhbmNlb2YgTGluZUxheW91dCkge1xuICAgIGlmIChuZXdQbGF5R2FsbGVyeUNvbmZpZy5zdHJhdGVneSAhPT0gUGxhaW5HYWxsZXJ5U3RyYXRlZ3kuUk9XICYmIG5ld1BsYXlHYWxsZXJ5Q29uZmlnLnN0cmF0ZWd5ICE9PSBQbGFpbkdhbGxlcnlTdHJhdGVneS5DT0xVTU4pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTGluZUxheW91dCByZXF1aXJlcyBlaXRoZXIgUk9XIG9yIENPTFVNTiBzdHJhdGVneScpO1xuICAgIH1cbiAgICBpZiAoIW5ld1BsYXlHYWxsZXJ5Q29uZmlnLmxheW91dCB8fCAhbmV3UGxheUdhbGxlcnlDb25maWcubGF5b3V0LmJyZWFrQ29uZmlnKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0JvdGggbGF5b3V0IGFuZCBicmVha0NvbmZpZyBtdXN0IGJlIHZhbGlkJyk7XG4gICAgfVxuICB9XG5cbiAgaWYgKG5ld1BsYXlHYWxsZXJ5Q29uZmlnLmxheW91dCBpbnN0YW5jZW9mIEdyaWRMYXlvdXQpIHtcbiAgICBpZiAobmV3UGxheUdhbGxlcnlDb25maWcuc3RyYXRlZ3kgIT09IFBsYWluR2FsbGVyeVN0cmF0ZWd5LkdSSUQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignR3JpZExheW91dCByZXF1aXJlcyBHUklEIHN0cmF0ZWd5Jyk7XG4gICAgfVxuICAgIGlmICghbmV3UGxheUdhbGxlcnlDb25maWcubGF5b3V0IHx8ICFuZXdQbGF5R2FsbGVyeUNvbmZpZy5sYXlvdXQuYnJlYWtDb25maWcpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQm90aCBsYXlvdXQgYW5kIGJyZWFrQ29uZmlnIG11c3QgYmUgdmFsaWQnKTtcbiAgICB9XG4gICAgLy8gZm9yY2Ugd3JhcCBmb3IgZ3JpZCBsYXlvdXRcbiAgICBuZXdQbGF5R2FsbGVyeUNvbmZpZy5sYXlvdXQuYnJlYWtDb25maWcud3JhcCA9IHRydWU7XG4gIH1cbiAgcmV0dXJuIG5ld1BsYXlHYWxsZXJ5Q29uZmlnO1xufVxuIl19